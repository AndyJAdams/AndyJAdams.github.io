<!DOCTYPE HTML>
<html>
<head>
    <meta lang="en/us"/>
    <meta encoding="UTF-8">
    <meta charset="UTF-8">
    <title>Stream_BRB</title>
    <style>
        body{
            margin: 0;
            touch-action: none;
            position: fixed;
            -webkit-touch-callout: none !important;
            -webkit-user-select: none !important;
        }
        canvas{
            touch-action: none;
            background-color: #000;
        }
    </style>
</head>
<body>
<canvas id='canvas'></canvas>
<script type='text/javascript'>
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var center = {
        x: innerWidth/2,
        y: innerHeight/2
    }
    var startTime = Date.now();
    var minuteBreak = 7;
    var timeRemaining = minuteBreak*60000;
    var timeElapsed = 0;
    
    
    function scaleCanvas(){
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        console.log('resized');
    }
    
    function animate(){
        
        if(timeRemaining > 0){
            ctx.strokeStyle='#FFF';
            ctx.fillStyle='#FFF';
        } else {
            ctx.strokeStyle='#F00';
            ctx.fillStyle='#F00';
        }
        
        
        window.requestAnimationFrame(animate);
        ctx.clearRect(0,0,innerWidth,innerHeight);
        
        //BRB Text
        ctx.font = '70px sans-serif';
        ctx.textAlign = 'left';
        var outtext = "BRB";
        if(timeRemaining < 0){
            outtext = "DED";
        }
        ctx.fillText(outtext,center.x-200,center.y-90);
        
        //Loading Box
        ctx.strokeRect(center.x-200,center.y-80,400,40);
        
        
        
        //Timer
        timeElapsed = Date.now()-startTime;
        timeRemaining = (minuteBreak*60000)-timeElapsed;
        
        var sign = "t- ";
        var minutes = Math.floor(timeRemaining/60000);
        var seconds = Math.floor((timeRemaining-(minutes*60000))/1000);
        var remainder = ""+((timeRemaining-(minutes*60000))-(seconds*1000));
        
        ctx.font = '40px sans-serif';
        ctx.textAlign = 'right';
        
        if(timeRemaining < 0){
            //negative time
            var rn = Date.now()-(startTime+(minuteBreak*60000));
            minutes = Math.floor(rn/60000);
            seconds = Math.floor((rn-(minutes*60000))/1000);
            remainder = (rn-(minutes*60000))-(seconds*1000);  
            sign = "t+ ";
        }
        if(minutes < 1){
            minutes = "0";
        }
        if(seconds < 10){
            seconds = "0"+seconds;
        }
        if(remainder < 100){
            if(remainder < 10){
                remainder = "00"+remainder;
            } else {
                remainder = "0"+remainder;
            }
        }
        ctx.fillText(sign+""+minutes+":"+seconds+"."+remainder, center.x+200,center.y);
            
        
        
        //Upload 
        ctx.font='14px sans-serif';
        ctx.fillText(timeElapsed+"/"+(minuteBreak*60000),center.x+200,center.y+20);
        
        //Loading Bar
        ctx.fillRect(center.x-195,center.y-75,(timeElapsed/(minuteBreak*60000))*390,30);
    }
    
    window.addEventListener('resize', scaleCanvas());
    
    scaleCanvas();
    animate();
</script>
</body>
</html>