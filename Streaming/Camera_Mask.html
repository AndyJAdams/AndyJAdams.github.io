<DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Camera_Mask</title>
	<style type="text/css">
		body{
            margin: 0;
            touch-action: none;
            position: fixed;
            -webkit-touch-callout: none !important;
            -webkit-user-select: none !important;
        }
        canvas{
            touch-action: none;
            background-color: #00000000;
        }
	</style>
</head>
<body id='body'>
<canvas></canvas>
	<script>
    var blocksize = 50;
	var canvas = document.querySelector('canvas');
    function scaleCanvas(){
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;
	}
	var ctx = canvas.getContext('2d');
    scaleCanvas();

    //We'll use blocks at first and set them to 40px size starting from top left
    function Block(x,y){
        this.s = Math.floor(Math.random()*40);
        this.x = x; this.y = y;
        this.grow = true;
        this.growrate = Math.floor(Math.random()*10)/10;
        
        this.draw = function(){
            //ctx.fillStyle='#FFF';
            ctx.clearRect(this.x-(this.s/2),this.y-(this.s/2),this.s, this.s);
        }
        
        this.update = function(){
            if(this.s > blocksize){
                this.grow = false;
                this.growrate = Math.floor(Math.random()*10)/10;
            } else if(this.s < 1){
                this.grow = true;
                this.growrate = Math.floor(Math.random()*10)/10;
            }
            if(this.grow){
                this.s += this.growrate;
            } else {
                this.s -= this.growrate;
            }
            this.draw();
        }
    }
        
        
    var blocks = [];
    function generate(){
        var rows = Math.ceil(innerHeight/blocksize);
        var cols = Math.ceil(innerWidth/blocksize);
        for(var i = 0; i < rows; i++){
            var chunk = [];
            for(var j = 0; j < cols; j++){
                chunk.push(new Block(j*blocksize+(blocksize/2),i*blocksize+(blocksize/2)));
            }
            blocks.push(chunk);
        }
    }
    //*************************************************
    //*************************************************
	function animate(){
		window.requestAnimationFrame(animate);
		//ctx.clearRect(0,0,innerWidth,innerHeight);
        ctx.fillStyle='#FFF';
        ctx.fillRect(0,0,innerWidth,innerHeight);
        
        if(blocks.length < 1){
            generate();
        }
        for(var i = 0; i < blocks.length;i++){
          for(var j = 0; j < blocks[i].length; j++){
              blocks[i][j].update();
          }  
        } 
	}
    //*************************************************
    //*************************************************

	//*** INPUT SECTION **//
    window.addEventListener('keyup',function(e){
        console.log(e.keyCode);
    });

    window.addEventListener('resize',function(evt){
        evt.preventDefault();
        scaleCanvas();
    });


    window.addEventListener('mousedown',inputStart,false);
    window.addEventListener('mousemove',inputMove,false);
    window.addEventListener('mouseup',inputEnd,false);

    window.addEventListener('touchstart',inputStart, false);
    window.addEventListener('touchmove', inputMove,false);
    window.addEventListener('touchcancel',inputEnd,false);
    window.addEventListener('touchend',inputEnd,false);

    var start = {x:-1,y:-1};
		var current = {x:-1,y:-1};
    function inputStart(evt){
        evt.preventDefault();
        if(evt.changedTouches != undefined){
            var touches = evt.changedTouches;
            if(touches.length > 0){
                start.x = touches[0].pageX;
                start.y = touches[0].pageY;
            }
        } else {
            start.x = evt.pageX;
            start.y = evt.pageY;
        }
				current.x = start.x;
				current.y = start.y;
    }

    function inputMove(evt){
        evt.preventDefault();
        if(start.x > -1){
            if(evt.changedTouches != undefined){
                var touches = evt.changedTouches;
                if(touches.length > 0){
                    current.x = touches[0].pageX;
                    current.y = touches[0].pageY;
                }
            } else {
                current.x = evt.pageX;
                current.y = evt.pageY;
            }
        }
    }

    function inputEnd(){
        start.x = -1;
    }
	animate();
	</script>
</body>
</html>
