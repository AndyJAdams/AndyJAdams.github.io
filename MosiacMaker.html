<!DOCTYPE HTML>
<html>
<head>
    <meta lang="en/us"/>
    <meta encoding="UTF-8">
    <meta charset="UTF-8">
    <title>Mosiac Maker</title>
    <style>
    </style>
</head>
<body>
<input type="text" id="imageSource"/>
<button onclick="LoadImage()">Import</button><button onclick="MakeMosaic()">Make Mosaic</button><br>
<h2>Mosaic</h2>
<canvas id='canvas'></canvas>
<script type='text/javascript'>
    var upscale = 20;
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var img;

    function LoadImage(){
        img = document.getElementById('source');
        var url = document.getElementById('imageSource').value;
        img.src = url;
        img.crossOrigin = "anonymous";
    }

    var colors = [];

    function MakeMosaic(){
        canvas.width = img.width*upscale;
        canvas.height = img.height*upscale;
        ctx.drawImage(img,0,0);
        var imgData = ctx.getImageData(0,0,img.width,img.height);
        for(var i = 0; i < imgData.data.length; i++){
            var color = "#";
            for(var a = 0; a < 3; a++){
                color += rgbToHex(imgData.data[i]);
                i++;
            }
            colors.push(color);
        }
        generateUpscale();
        //console.log(colors);
    }

    function generateUpscale(){
        console.log(img.width);

        for(var i = 0; i < colors.length; i++){
            var y = Math.floor(i/img.width);
            var x = i - (y*img.width);
            ctx.fillStyle= colors[i];
            ctx.fillRect(x*upscale,y*upscale,upscale,upscale);
        }
    }

    function rgbToHex(n){
        var hex = Number(n).toString(16);
        if(hex.length < 2){
            hex = "0"+hex;
        }
        return hex;
    }

    function Hexi(r,g,b){
        var red = rgbToHex(r);
        var green = rgbToHex(g);
        var blue = rgbToHex(b);
        return red+green+blue;
    }
</script>
<img src='#' id='source' style="visibility: hidden;"/>
</body>
</html>
