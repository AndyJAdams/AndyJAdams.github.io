<!DOCTYPE html>
<html>
<head>
	<title>TRACKER</title>
	<style>
	body{
		margin:0; overflow: hidden;
	}
	</style>
</head>
<body>
	<canvas id='canvas'></canvas>
	<script type='text/javascript'>
	var canvas = document.querySelector('canvas');
	var ctx = canvas.getContext('2d');

	var center = {x:0,y:0};

	function scaleCanvas(){
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;
		center.x = innerWidth/2; 
		center.y = innerHeight/2;
	}
	scaleCanvas();

	function Target(x,y,radius){
		this.x = x; this.y = y; this.radius = radius;
		this.dx = this.x; this.dy = this.y;
		this.speed = 0.5;

		this.draw = function(){
			ctx.beginPath();
			ctx.arc(this.x, this.y, this.radius, 0, 2*Math.PI);
			ctx.fill();

			ctx.beginPath();
			ctx.moveTo(this.x, this.y);
			ctx.lineTo(this.dx, this.dy);
			ctx.stroke();

			ctx.fillRect(this.dx-2, this.dy-2, 4,4);
		}

		this.update = function(){
			if(Math.abs(this.x-this.dx) < 5 && Math.abs(this.y-this.dy) < 5){
				this.dx += (Math.random()-0.5)*innerWidth;
				this.dy += (Math.random()-0.5)*innerHeight;
				this.speed = Math.random()+1;
			} 

			

			if(this.x < this.dx){
				this.x += this.speed;
			} else if(this.x > this.dx){
				this.x -= this.speed;
			}

			if(this.y < this.dy){
				this.y += this.speed;
			} else if(this.y > this.dy){
				this.y -= this.speed;
			}

			this.dx += force.x;
			this.x += force.x;
			this.dy += force.y;
			this.y += force.y;
			this.draw();
		}
	}
	var force = {x: 0, y: 0};
	var target = new Target(center.x, center.y, 27);
	
	function animate(){
		requestAnimationFrame(animate);
		ctx.clearRect(0,0,innerWidth,innerHeight);

		target.update();
	}

	function getDistance(x1,y1,x2,y2){
		return Math.abs(Math.sqrt(Math.pow(x1-x2,2)+Math.pow(y1-y2,2)));
	}

	document.addEventListener('keydown',keyInput,false);

	function keyInput(evt){
		
		switch(evt.key){
			case 'w':
			case 'ArrowUp':
				force.y += 0.5;
				break;
			case 'a':
			case 'ArrowLeft':
				force.x += 0.5;
				break;
			case 's':
			case 'ArrowDown':
				force.y -= 0.5;
				break;
			case 'd':
			case 'ArrowRight':
				force.x -= 0.5;
				break;

		}
	}

	document.addEventListener('mousedown', inputStart, false);
	document.addEventListener('mousemove', inputMove, false);
	document.addEventListener('mouseup', inputEnd, false);

	var start={x:-1,y:-1};
	var current={x:-1,y:-1};
	function inputStart(evt){
		evt.preventDefault();
		start.x = evt.pageX;
		start.y = evt.pageY;
		current.x = start.x;
		current.y = start.y;
	}

	function inputMove(evt){
		evt.preventDefault();

	}

	function inputEnd(evt){
		evt.preventDefault();
		if(start.x > -1){
			var x = evt.pageX;
			var y = evt.pageY;
			force.y += (y-start.y)/(innerHeight/10);
			force.x += (x-start.x)/(innerWidth/10);
		}
		start.x = -1;
	}

	scaleCanvas();
	animate();
	</script>
</body>
</html>