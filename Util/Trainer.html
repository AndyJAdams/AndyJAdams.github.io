<!DOCTYPE HTML>
<html>
<head>
    <meta lang="en/us"/>
    <meta encoding="UTF-8">
    <meta charset="UTF-8">
    <title>Trainer</title>
    <style>
        body{
            margin: 0;
            touch-action: none;
            position: fixed;
            -webkit-touch-callout: none !important;
            -webkit-user-select: none !important;
        }
        canvas{
            touch-action: none;
        }
        #menu{
            position: absolute;
            top:10px;
            left:0;
            width:200px;
            height:100%;
            text-align: center;
        }
        button{
            width:180px;
            height:40px;
        }
    </style>
</head>
<body>
    <div id='menu'>
        <button onclick="setMode(0)">Straight Lines</button><br>
        <button onclick="setMode(1)">Curves</button><br>
        <button onclick="setMode(2)">Elipsis</button><br>
        <button onclick="setMode(3)">Shapes</button><br>
        <button onclick="setMode(4)">1pt Perspective</button><br>
        <button onclick="setMode(5)">2pt Perspective</button><br>
        <button onclick="setMode(6)">3pt Perspective</button><br>
        <p id='stats'>Accuracy: 0%<br>
            Time: 0.000s<br>
        </p>
    </div>
<canvas id='canvas'></canvas>
<script type='text/javascript'>
    
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var mode = 0;
    var points = [];

    var startTime = -1;
    var targets = [];

    function Point(x,y){
        this.x = x;
        this.y = y;
    }


    function setMode(val){
        mode=val;
    }
    
    function scaleCanvas(){
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    function assignTargets(){
        switch(mode){
            case 0: //Straightlines
                targets.push(new Point(Math.floor(Math.random()*(innerWidth-200))+200,Math.floor(Math.random()*innerHeight)));
                targets.push(new Point(Math.floor(Math.random()*(innerWidth-200))+200,Math.floor(Math.random()*innerHeight)));
                break;
            default:
                break;
        }
    }
    
    
    //*****************************************************************
    //*****************************************************************


    
    function animate(){
        window.requestAnimationFrame(animate);
        ctx.clearRect(0,0,innerWidth,innerHeight);
        
        ctx.fillStyle='#FFF';
        ctx.fillRect(0,0,innerWidth,innerHeight);

        for(var i = 0; i < targets.length; i++){
            ctx.beginPath();
            ctx.arc(targets[i].x,targets[i].y,5,0,2*Math.PI);
            ctx.stroke();
            ctx.closePath();
        }
    
        if(points.length > 1){
            ctx.beginPath();
            ctx.moveTo(points[0].x,points[0].y);
            for(var i = 1; i < points.length; i++){
                ctx.lineTo(points[i].x,points[i].y);
            }
            ctx.stroke();
            ctx.closePath();
        }
    }

    //*****************************************************************
    //*****************************************************************


    //*** INPUT SECTION **//
    
    window.addEventListener('resize',function(evt){
        evt.preventDefault();
        scaleCanvas();
    });
    
    
    window.addEventListener('mousedown',inputStart,false);
    window.addEventListener('mousemove',inputMove,false);
    window.addEventListener('mouseup',inputEnd,false);

    window.addEventListener('touchstart',inputStart, false);
    window.addEventListener('touchmove', inputMove,false);
    window.addEventListener('touchcancel',inputEnd,false);
    window.addEventListener('touchend',inputEnd,false);
    
    function inputStart(evt){
        if(evt.changedTouches != undefined){
            var touches = evt.changedTouches;
            if(touches.length > 0){
                points.push(new Point(touches[0].pageX, touches[0].pageY));
            }
        } else {
            evt.preventDefault();
            points.push(new Point(evt.pageX,evt.pageY));
        }
        startTime = Date.now();
    }
    
    function inputMove(evt){
        if(points.length > 0){
            if(evt.changedTouches != undefined){
                var touches = evt.changedTouches;
                if(touches.length > 0){
                    points.push(new Point(touches[0].pageX, touches[0].pageY));
                }
            } else {
                evt.preventDefault();
                points.push(new Point(evt.pageX,evt.pageY));
            }
        }
    }
    
    function inputEnd(){
        var endTime = Date.now();
        var totalTime = endTime-startTime;
        console.log(totalTime/1000);
        var stats = document.getElementById('stats');
        stats.innerHTML = "Accuracy: 5%<br>Time: "+(totalTime/1000)+"s";
        points.length = 0;
        targets.length = 0;
        assignTargets();
    }
    
    scaleCanvas();
    assignTargets();
    animate();
    
</script>
</body>
</html>